<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment App Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: WhatsApp Inspired Neutrals -->
    <!-- Application Structure Plan: A tab-based SPA structure was chosen for superior usability. It separates the primary user task (sending money via the 'Chat' tab) from secondary tasks like reviewing past payments ('History' tab) and managing account details ('Settings' tab). This non-linear, task-oriented structure is more intuitive and scalable than a simple linear progression of screens. The core payment flow is handled via a sequence of modals to maintain context and focus the user on the transaction process from initiation to completion. -->
    <!-- Visualization & Content Choices: Report Info: Transaction list -> Goal: Inform/Compare -> Viz: Interactive list with filters and a summary bar chart (Chart.js/Canvas) -> Interaction: Users can filter transactions by status (Completed, Incomplete) to quickly find information. The chart provides a high-level comparison of spending per recipient. Report Info: Settings options -> Goal: Organize/Inform -> Viz: Toggled list (HTML/CSS) -> Interaction: Users can tap options to navigate or toggle switches to change security settings. This approach makes complex information easily digestible and interactive. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-active { color: #16a34a; border-color: #16a34a; }
        .tab-inactive { color: #6b7280; border-color: transparent; }
        .modal-hidden { display: none; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="app-container" class="max-w-md mx-auto bg-white shadow-lg h-screen flex flex-col">

        <!-- Main Content -->
        <main id="main-content" class="flex-grow overflow-y-auto pb-20">
            <!-- Chat/Home View -->
            <div id="view-chat" class="page-view p-4">
                 <div class="text-center mb-4 border-b pb-4">
                    <h1 class="text-xl font-bold">Liam</h1>
                    <p class="text-sm text-gray-500">This section simulates the chat where a payment can be initiated. Click the payment suggestion or the dollar icon below to start the payment process.</p>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-start"><div class="bg-gray-200 rounded-lg px-3 py-2 max-w-xs">Hey Jason, are we still on for the weekend? <span class="text-xs text-gray-500 block text-right">11:15</span></div></div>
                    <div class="flex justify-end"><div class="bg-green-100 text-green-900 rounded-lg px-3 py-2 max-w-xs">Yes, looking forward to it! <span class="text-xs text-gray-500 block text-right">11:17</span></div></div>
                    <div class="flex justify-start"><div class="bg-gray-200 rounded-lg px-3 py-2 max-w-xs">Great! <span class="text-xs text-gray-500 block text-right">11:19</span></div></div>
                    <div class="flex justify-start"><div class="bg-gray-200 rounded-lg px-3 py-2 max-w-xs">Can you send me $50 for the tickets? <span class="text-xs text-gray-500 block text-right">11:20</span></div></div>
                    <div class="flex justify-start">
                        <button class="bg-white border border-green-500 text-green-600 font-semibold rounded-lg px-4 py-2 hover:bg-green-50 transition-colors" onclick="startPayment()">Suggestion: Pay $50</button>
                    </div>
                </div>
                <div class="fixed bottom-16 left-1/2 -translate-x-1/2 w-full max-w-md px-4 py-2 bg-white border-t">
                    <div class="flex items-center">
                        <input type="text" placeholder="Type a message" class="flex-grow border rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        <button class="ml-2 text-gray-500 p-2">📎</button>
                        <button class="ml-1 text-gray-500 p-2">🎤</button>
                        <button class="ml-1 bg-green-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl" onclick="startPayment()">$</button>
                    </div>
                </div>
            </div>

            <!-- History View -->
            <div id="view-history" class="page-view hidden">
                 <div class="p-4 border-b">
                    <h1 class="text-xl font-bold text-center">Transaction History</h1>
                    <p class="text-sm text-gray-500 text-center mt-2">Here you can review all your past transactions. Use the filters to sort through your payment history and see a visual summary of your spending by recipient in the chart below.</p>
                </div>
                <div class="p-4">
                    <div class="chart-container relative w-full max-w-xl mx-auto h-64 sm:h-80">
                        <canvas id="transactionsChart"></canvas>
                    </div>
                </div>
                <div class="px-4 pt-4">
                    <div class="flex justify-center space-x-2 mb-4 border-b pb-4">
                        <button class="history-filter-btn px-4 py-1.5 text-sm font-semibold rounded-full bg-green-600 text-white" data-filter="all">All</button>
                        <button class="history-filter-btn px-4 py-1.5 text-sm font-semibold rounded-full bg-gray-200 text-gray-700" data-filter="completed">Completed</button>
                        <button class="history-filter-btn px-4 py-1.5 text-sm font-semibold rounded-full bg-gray-200 text-gray-700" data-filter="incomplete">Incomplete</button>
                    </div>
                    <ul id="transaction-list" class="space-y-4"></ul>
                </div>
            </div>

            <!-- Settings View -->
            <div id="view-settings" class="page-view hidden">
                <div class="p-4 border-b">
                    <h1 class="text-xl font-bold text-center">Settings</h1>
                    <p class="text-sm text-gray-500 text-center mt-2">Manage your linked accounts, adjust security preferences, and access your transaction history. Your settings control how you send and protect your money.</p>
                </div>
                <div class="p-4 space-y-6">
                    <div>
                        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Linked Accounts</h2>
                        <div class="bg-white rounded-lg shadow-sm">
                            <a href="#" class="flex justify-between items-center p-3 hover:bg-gray-50" onclick="showLinkedAccounts(event)">
                                <span>MyBank Checking</span>
                                <span class="text-gray-400">&gt;</span>
                            </a>
                        </div>
                    </div>
                     <div>
                        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Security Options</h2>
                        <div class="bg-white rounded-lg shadow-sm divide-y">
                            <div class="flex justify-between items-center p-3">
                                <label for="pin-toggle">Require PIN</label>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" name="pin-toggle" id="pin-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" checked/>
                                    <label for="pin-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                </div>
                            </div>
                            <div class="flex justify-between items-center p-3">
                               <label for="faceid-toggle">Enable Face ID</label>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" name="faceid-toggle" id="faceid-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" checked/>
                                    <label for="faceid-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div>
                        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">View Transaction History</h2>
                        <div class="bg-white rounded-lg shadow-sm">
                            <a href="#" class="flex justify-between items-center p-3 hover:bg-gray-50" onclick="navigateToTab('history')">
                                <span>See All Transactions</span>
                                <span class="text-gray-400">&gt;</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Tab Navigation -->
        <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md bg-white border-t">
            <div class="flex justify-around">
                <button class="nav-tab flex-1 text-center py-3 border-b-2 tab-active" data-view="chat">
                    <span class="text-2xl">💬</span>
                    <span class="block text-xs">Chat</span>
                </button>
                <button class="nav-tab flex-1 text-center py-3 border-b-2 tab-inactive" data-view="history">
                    <span class="text-2xl">📖</span>
                    <span class="block text-xs">History</span>
                </button>
                <button class="nav-tab flex-1 text-center py-3 border-b-2 tab-inactive" data-view="settings">
                    <span class="text-2xl">⚙️</span>
                    <span class="block text-xs">Settings</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- Modals Container -->
    <div id="modal-container"></div>

    <script>
        const appState = {
            currentView: 'chat',
            transactions: [
                { id: '1', name: 'Samuel', date: 'Today', amount: 50.00, status: 'completed', txId: '6789012345' },
                { id: '2', name: 'Michelle', date: 'Apr 18', amount: 100.00, status: 'completed', txId: '5678901234' },
                { id: '3', name: 'Daniel', date: 'Apr 15', amount: 25.00, status: 'completed', txId: '4567019283' },
                { id: '4', name: 'Ethan', date: 'Apr 12', amount: 50.00, status: 'incomplete', txId: '3456780129' },
                { id: '5', name: 'Stephanie', date: 'Mar 21', amount: 40.00, status: 'completed', txId: '2345678901' },
            ],
            transactionsChart: null,
        };

        const modalContainer = document.getElementById('modal-container');

        function navigateToTab(viewId) {
            document.querySelectorAll('.page-view').forEach(view => view.classList.add('hidden'));
            document.getElementById(`view-${viewId}`).classList.remove('hidden');

            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('tab-active');
                tab.classList.add('tab-inactive');
                if (tab.dataset.view === viewId) {
                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');
                }
            });
            appState.currentView = viewId;

            if (viewId === 'history') {
                renderTransactionHistory('all');
                renderTransactionsChart();
            }
        }

        function renderTransactionHistory(filter) {
            const list = document.getElementById('transaction-list');
            list.innerHTML = '';
            const filteredTransactions = appState.transactions.filter(t => filter === 'all' || t.status === filter);
            
            if (filteredTransactions.length === 0) {
                list.innerHTML = `<li class="text-center text-gray-500 py-8">No transactions found.</li>`;
                return;
            }

            filteredTransactions.forEach(t => {
                const item = document.createElement('li');
                item.className = 'flex items-center justify-between p-3 bg-white rounded-lg shadow-sm';
                item.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center mr-3 font-bold text-gray-600">${t.name.charAt(0)}</div>
                        <div>
                            <div class="font-semibold">${t.name}</div>
                            <div class="text-xs text-gray-500">${t.date} &bull; TX ${t.txId}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-lg ${t.status === 'incomplete' ? 'text-red-500' : 'text-gray-800'}">$${t.amount.toFixed(2)}</div>
                        ${t.status === 'incomplete' ? '<div class="text-xs text-red-500 capitalize">Incomplete</div>' : ''}
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function renderTransactionsChart() {
            const ctx = document.getElementById('transactionsChart').getContext('2d');
            if (appState.transactionsChart) {
                appState.transactionsChart.destroy();
            }

            const completedTransactions = appState.transactions.filter(t => t.status === 'completed');
            const spendingByPerson = completedTransactions.reduce((acc, t) => {
                acc[t.name] = (acc[t.name] || 0) + t.amount;
                return acc;
            }, {});

            const labels = Object.keys(spendingByPerson);
            const data = Object.values(spendingByPerson);

            appState.transactionsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Total Sent',
                        data: data,
                        backgroundColor: 'rgba(22, 163, 74, 0.7)',
                        borderColor: 'rgba(22, 163, 74, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { display: false } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false }, title: { display: true, text: 'Total Payments to Recipients' } }
                }
            });
        }
        
        function showModal(content) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = content;
            modalContainer.appendChild(modal);
        }

        function closeModal() {
            modalContainer.innerHTML = '';
        }

        function startPayment() {
            const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm animate-fade-in-up">
                    <div class="p-6 text-center">
                        <div class="text-gray-500 text-sm">PAYING</div>
                        <div class="font-bold text-2xl mt-1">Ethan</div>
                        <div class="text-5xl font-bold my-6">$50.00</div>
                        <div class="text-left">
                            <label class="text-sm font-semibold text-gray-600">Note (Optional)</label>
                            <input type="text" placeholder="e.g., For the tickets" class="w-full mt-1 border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                         <div class="text-left mt-4">
                            <label class="text-sm font-semibold text-gray-600">Account</label>
                            <select class="w-full mt-1 border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option>MyBank Checking</option>
                            </select>
                        </div>
                        <div class="mt-8">
                            <button class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors" onclick="showPinAuth()">Confirm & Send</button>
                            <button class="w-full mt-2 text-gray-600 font-semibold py-2 rounded-lg hover:bg-gray-100" onclick="closeModal()">Cancel</button>
                        </div>
                    </div>
                </div>`;
            showModal(content);
        }

        function showPinAuth() {
            const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6 text-center">
                    <h2 class="text-2xl font-bold">Enter PIN</h2>
                    <p class="text-gray-600 mt-2">Enter your PIN to send the payment.</p>
                    <div class="flex justify-center space-x-3 my-6">
                        <div class="w-4 h-4 rounded-full border-2 border-gray-400"></div>
                        <div class="w-4 h-4 rounded-full border-2 border-gray-400"></div>
                        <div class="w-4 h-4 rounded-full border-2 border-gray-400"></div>
                        <div class="w-4 h-4 rounded-full border-2 border-gray-400"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 my-6">
                         <button class="w-full border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-100" onclick="showPaymentSuccess()">Use Face ID</button>
                         <button class="w-full border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-100" onclick="showPaymentSuccess()">Use Fingerprint</button>
                    </div>
                    <div class="grid grid-cols-3 gap-3">
                        ${[1, 2, 3, 4, 5, 6, 7, 8, 9, '', 0, '⌫'].map(k => `<button class="text-2xl py-3 rounded-lg hover:bg-gray-100" ${k === '' ? 'disabled' : ''} onclick="${k === '⌫' ? 'showPaymentSuccess()' : 'showPaymentSuccess()'}">${k}</button>`).join('')}
                    </div>
                    <button class="w-full mt-6 text-gray-600 font-semibold py-2" onclick="closeModal()">Cancel</button>
                </div>
            `;
            showModal(content);
        }
        
        function showPaymentSuccess() {
             const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-8 text-center">
                    <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto">
                        <span class="text-white text-5xl">✓</span>
                    </div>
                    <h2 class="text-3xl font-bold mt-6">Payment Sent</h2>
                    <p class="text-gray-600 text-lg mt-2">to Ethan</p>
                    <p class="text-4xl font-bold my-4">$50.00</p>
                    <p class="text-sm text-gray-500">TX12345678</p>
                    <button class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors mt-8" onclick="closeModal()">Done</button>
                </div>
            `;
            showModal(content);
        }

        function showLinkedAccounts(event) {
            event.preventDefault();
            const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6">
                     <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Linked Accounts</h2>
                        <button class="text-2xl" onclick="closeModal()">&times;</button>
                     </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-3 border rounded-lg">
                           <div>
                                <div class="font-semibold">MyBank Checking</div>
                                <div class="text-sm text-gray-500">mybank.com</div>
                           </div>
                           <span class="text-gray-400">&gt;</span>
                        </div>
                    </div>
                    <button class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors mt-6" onclick="showLinkNewBank()">Link new account</button>
                </div>
            `;
            showModal(content);
        }

        function showLinkNewBank() {
            const banks = ['MyBank', 'National Trust', 'Financial Partners', 'Citizens Bank', 'Founders Federal'];
            const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6">
                     <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Link New Bank</h2>
                        <button class="text-2xl" onclick="showLinkedAccounts(event)">&times;</button>
                     </div>
                     <p class="text-gray-600 mb-4">Select your bank or search by name.</p>
                     <div class="space-y-2">
                        ${banks.map(bank => `<button class="w-full text-left p-3 border rounded-lg hover:bg-gray-50" onclick="showBankLinkedSuccess()">${bank}</button>`).join('')}
                     </div>
                     <button class="w-full mt-6 text-gray-600 font-semibold py-2" onclick="showLinkedAccounts(event)">Cancel</button>
                </div>
            `;
            showModal(content);
        }
        
        function showBankLinkedSuccess() {
             const content = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-8 text-center">
                    <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto">
                        <span class="text-white text-5xl">✓</span>
                    </div>
                    <h2 class="text-3xl font-bold mt-6">Bank linked successfully</h2>
                    <button class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors mt-8" onclick="showLinkedAccounts(event)">Done</button>
                </div>
            `;
            showModal(content);
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => navigateToTab(tab.dataset.view));
            });
            document.querySelectorAll('.history-filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                     document.querySelectorAll('.history-filter-btn').forEach(b => {
                        b.classList.remove('bg-green-600', 'text-white');
                        b.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    btn.classList.add('bg-green-600', 'text-white');
                    btn.classList.remove('bg-gray-200', 'text-gray-700');
                    renderTransactionHistory(btn.dataset.filter);
                });
            });
            
            const style = document.createElement('style');
            style.innerHTML = `
                .toggle-checkbox:checked { right: 0; border-color: #16a34a; }
                .toggle-checkbox:checked + .toggle-label { background-color: #16a34a; }
            `;
            document.head.appendChild(style);
        });

    </script>
</body>
</html>
